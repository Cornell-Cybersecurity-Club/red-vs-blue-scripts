# /etc/security/pwquality.conf
# Configuration for the pam_pwquality module.
# Hardened by System Administrator

# ----------------------------------------------------
# 1. PASSWORD LENGTH
# ----------------------------------------------------

# Minimum acceptable size for the new password.
# CIS Benchmark Recommendation: 14
minlen = 14

# ----------------------------------------------------
# 2. CHARACTER COMPLEXITY
# ----------------------------------------------------
# The logic here is counter-intuitive:
# Positive integers (>0) = Bonus credit towards length (not a hard requirement).
# Negative integers (<0) = Hard requirement. You MUST have at least this many.

# Require at least 1 digit
dcredit = -1

# Require at least 1 uppercase character
ucredit = -1

# Require at least 1 lowercase character
lcredit = -1

# Require at least 1 special character (symbol)
ocredit = -1

# Alternatively, you can use 'minclass' instead of the credits above.
# minclass = 4  # Requires characters from at least 4 different classes (Upper, Lower, Digit, Symbol)

# ----------------------------------------------------
# 3. PREVENTING PREDICTABLE PASSWORDS
# ----------------------------------------------------

# Number of characters in the new password that must not be present in the
# old password. This prevents changing "Password123" to "Password124".
difok = 3

# Checks if the password contains the user name in some form.
# 1 = Enabled.
reject_username = 1

# Check against a dictionary of common words (cracklib).
# 1 = Enabled.
dictcheck = 1

# ----------------------------------------------------
# 4. ROOT USER ENFORCEMENT
# ----------------------------------------------------

# Enforces pwquality checks on the root user.
# WARNING: If set to 1, you cannot force a weak password for root,
# even using sudo. Be careful not to lock yourself out if you
# can't think of a compliant password during an emergency reset.
enforce_for_root = 1
