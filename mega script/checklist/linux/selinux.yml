version: 1.0
name: SELinux
vulnerabilities:
  - cid: C-F-SE-01
    operating_systems:
      - Fedora
    category: SELinux
    policy: Ensure SELinux is installed
    fix:
      - fix_type: command
        command: dnf install -y libselinux
    references:
      cid:
        id: 1.7.1.1
        category: L1
  - cid: C-F-SE-02
    operating_systems:
      - Fedora
    category: SELinux
    policy: Ensure SELinux is not disabled in bootloader configuration
    fix:
      - fix_type: manual
        steps: |
          1. Edit /etc/default/grub and remove all instances of selinux=0 and enforcing=0 from all CMDLINE_LINUX parameters
          2. Run `grub2-mkconfig -o /boot/grub2/grub.cfg`
    references:
      cid:
        id: 1.7.1.2
        category: L1
  - cid: C-F-SE-03
    operating_systems:
      - Fedora
    category: SELinux
    policy: Ensure SELinux is configured properly
    fix:
      - fix_type: config_file_copyover
        file: /etc/selinux/config
        source: ./support/linux/config_files/fed36/selinux_config
      - fix_type: command
        command: setenforce 1
    references:
      cid:
        id: 1.7.1.3-1.7.1.4
        category: L1
  - cid: C-F-SE-04
    operating_systems:
      - Fedora
    category: SELinux
    policy: Ensure no unconfined services exist
    fix:
      - fix_type: manual
        steps: |
          1. Run `ps -eZ | grep unconfined_service_t`
          2. Investigate any unconfined processes found during the audit action. They may need to have an existing security context assigned to them or a policy built for them.
    references:
      cid:
        id: 1.7.1.5
        category: L1
  - cid: C-F-SE-05
    operating_systems:
      - Fedora
    category: SELinux
    policy: Ensure SETroubleshoot is not installed
    fix:
      - fix_type: command
        command: dnf remove -y setroubleshoot
    references:
      cid:
        id: 1.7.1.6
        references: L1
  - cid: C-F-SE-06
    operating_systems:
      - Fedora
    category: SELinux
    policy: Ensure the MCS Translation Service (mcstrans) is not installed
    fix:
      - fix_type: command
        command: dnf remove -y mcstrans
    references:
      cid:
        id: 1.7.1.7
        category: L1
